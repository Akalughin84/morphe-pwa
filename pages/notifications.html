<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Morphe ‚Äî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</title>
  <link rel="stylesheet" href="../styles.css" />
  <link rel="stylesheet" href="../styles-form.css" />
</head>
<body>
  <header class="page-header">
    <div class="container">
      <a href="../index.html" class="logo-link">
        <div class="logo">Morphe</div>
      </a>
      <nav class="page-nav">
        <a href="../pages/profile.html" class="nav-link">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
        <a href="../pages/workouts.html" class="nav-link">üí™ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</a>
      </nav>
    </div>
  </header>

  <main class="notifications-page">
    <div class="container">
      <h1>üîî –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏</h1>
      <p>–ù–∞—Å—Ç—Ä–æ–π –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ –ø—Ä–∏—ë–º—ã –ø–∏—â–∏.</p>

      <div class="form-container">
        <div class="form-group">
          <label for="remType">–¢–∏–ø –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</label>
          <select id="remType">
            <option value="workout">üèãÔ∏è‚Äç‚ôÇÔ∏è –ü–æ—Ä–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è!</option>
            <option value="meal">üçΩ –ü—Ä–∏—ë–º –ø–∏—â–∏</option>
            <option value="custom">üìù –°–≤–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ</option>
          </select>
        </div>

        <div class="form-group">
          <label for="remTime">–í—Ä–µ–º—è</label>
          <input type="time" id="remTime" required>
        </div>

        <div class="form-group" id="customMessageGroup" style="display:none;">
          <label for="remMessage">–¢–µ–∫—Å—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</label>
          <input type="text" id="remMessage" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –í—ã–ø–µ–π –≤–æ–¥—ã">
        </div>

        <div class="form-group">
          <label>
            <input type="checkbox" id="remRepeat" checked> –ü–æ–≤—Ç–æ—Ä—è—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω–æ
          </label>
        </div>

        <button onclick="addReminder()" class="btn-primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ</button>
      </div>

      <div id="remindersList">
        <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
      </div>
    </div>
  </main>

  <script type="module">
    import { NotificationManager } from '../modules/notifications.js';

    const manager = new NotificationManager();
    const listEl = document.getElementById('remindersList');

    const remType = document.getElementById('remType');
    const remTime = document.getElementById('remTime');
    const remMessage = document.getElementById('remMessage');
    const customMessageGroup = document.getElementById('customMessageGroup');
    const remRepeat = document.getElementById('remRepeat');

    // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å/—Å–∫—Ä—ã–≤–∞—Ç—å –ø–æ–ª–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    remType.addEventListener('change', () => {
      customMessageGroup.style.display = remType.value === 'custom' ? 'block' : 'none';
    });

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
    function addReminder() {
      const type = remType.value;
      const time = remTime.value;
      const message = remType.value === 'custom' 
        ? remMessage.value.trim() || '–ù–æ–≤–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ'
        : remType.options[remType.selectedIndex].text;

      const repeat = remRepeat.checked;

      if (!time) {
        alert("–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è!");
        return;
      }

      manager.addReminder(type, time, message, repeat);
      renderList();
      alert(`‚úÖ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –Ω–∞ ${time}`);
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
    function renderList() {
      if (manager.schedule.length === 0) {
        listEl.innerHTML = '<p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π.</p>';
        return;
      }

      listEl.innerHTML = `
        <h3>üìÖ –ê–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</h3>
        <ul class="reminder-list">
          ${manager.schedule.map(r => `
            <li>
              <strong>${r.time}</strong>: ${r.message}
              <button onclick="removeRem(${r.id})" style="margin-left: 1rem; color: #ef4444;">üóë –£–¥–∞–ª–∏—Ç—å</button>
            </li>
          `).join('')}
        </ul>
      `;
    }

    // –£–¥–∞–ª–µ–Ω–∏–µ
    window.removeRem = (id) => {
      manager.removeReminder(id);
      renderList();
    };

    // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    window.addReminder = addReminder;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    manager.autoStart();
    renderList();
  </script>
</body>
</html>