<!-- /pages/onboarding.html -->
<!-- v1.6.0 ‚Äî –û–Ω–±–æ—Ä–¥–∏–Ω–≥ -->

<!DOCTYPE html>
<html lang="ru" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å ‚Äî Morphe</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/icon-32.png">
  <link rel="apple-touch-icon" href="/assets/icons/icon-192.png">
  <link rel="manifest" href="/manifest.json">

  <!-- –°—Ç–∏–ª–∏ -->
  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="/styles-shared.css">

  <!-- Skip-link -->
  <style>
    .skip-link {
      position: absolute;
      top: -40px;
      left: 10px;
      background: #000;
      color: #fff;
      padding: 8px;
      text-decoration: none;
      z-index: 1000;
      transition: top 0.3s;
    }
    .skip-link:focus { top: 10px; }
  </style>
</head>
<body>



  <!-- –ó–∞–≥–ª—É—à–∫–∞ —à–∞–ø–∫–∏ -->
  <div id="header-placeholder"></div>

  <main id="main-content">
    <div class="container">
      <div class="onboarding-container">
        <div class="onboarding-progress">
          <div class="progress-bar">
            <div id="onboardingProgress" class="bar-fill" style="width: 0%"></div>
          </div>
          <small id="stepCounter">–®–∞–≥ 1 –∏–∑ 4</small>
        </div>

        <div id="onboardingSlides">
          <!-- –°–ª–∞–π–¥ 1 -->
          <div class="slide active" data-step="1">
            <div class="slide-icon">üå±</div>
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Morphe</h2>
            <p>–≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –≠—Ç–æ –≤–∞—à —Ü–∏—Ñ—Ä–æ–≤–æ–π –¥–≤–æ–π–Ω–∏–∫ ‚Äî –ø–æ–º–æ—â–Ω–∏–∫ –≤ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏.</p>
            <p><strong>–ù–∏–∫–∞–∫–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫. –ù–∏–∫–∞–∫–æ–π —Ä–µ–∫–ª–∞–º—ã. –¢–æ–ª—å–∫–æ –≤—ã –∏ –≤–∞—à —Ä–æ—Å—Ç.</strong></p>
          </div>

          <!-- –°–ª–∞–π–¥ 2 -->
          <div class="slide" data-step="2">
            <div class="slide-icon">üéØ</div>
            <h2>–í–∞—à–∞ —Ü–µ–ª—å ‚Äî –≤–∞—à–∞ –∏—Å—Ç–æ—Ä–∏—è</h2>
            <p>Morphe –Ω–µ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –≤–∞—Å –≤ –∫–æ–≥–æ-—Ç–æ –¥—Ä—É–≥–æ–≥–æ. –û–Ω –ø–æ–º–æ–≥–∞–µ—Ç —Å—Ç–∞—Ç—å –ª—É—á—à–µ–π –≤–µ—Ä—Å–∏–µ–π —Å–µ–±—è.</p>
            <p>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å ‚Äî –∏ –Ω–∞—á–Ω—ë—Ç—Å—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è.</p>
          </div>

          <!-- –°–ª–∞–π–¥ 3 -->
          <div class="slide" data-step="3">
            <div class="slide-icon">üß†</div>
            <h2>–£–º–Ω—ã–π, –Ω–æ –ø—Ä–æ—Å—Ç–æ–π</h2>
            <p>AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∏ –¥–∞—ë—Ç —Å–æ–≤–µ—Ç—ã ‚Äî –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞.</p>
            <p>–í—ã ‚Äî —Ö–æ–∑—è–∏–Ω —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö.</p>
          </div>

          <!-- –°–ª–∞–π–¥ 4 -->
          <div class="slide" data-step="4">
            <div class="slide-icon">üöÄ</div>
            <h2>–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å?</h2>
            <p>–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã –ø–æ–ø–∞–¥—ë—Ç–µ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ —Å–º–æ–∂–µ—Ç–µ:</p>
            <ul>
              <li>–ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</li>
              <li>–ù–∞—á–∞—Ç—å –ø–µ—Ä–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</li>
              <li>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –ø–∏—Ç–∞–Ω–∏—è</li>
            </ul>
          </div>
        </div>

        <div class="onboarding-controls">
          <button id="prevBtn" class="btn-outline" disabled>‚Üê –ù–∞–∑–∞–¥</button>
          <button id="nextBtn" class="btn-primary">–î–∞–ª–µ–µ ‚Üí</button>
          <button id="skipBtn" class="btn-text">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
        </div>
      </div>
    </div>
  </main>

  <!-- –ó–∞–≥–ª—É—à–∫–∞ –ø–æ–¥–≤–∞–ª–∞ -->
  <div id="footer-placeholder"></div>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js');
      });
    }
  </script>

  <!-- –õ–æ–≥–∏–∫–∞ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ -->
  <script type="module">
    import { HeaderController } from '/core/HeaderController.js';
    import { ThemeManager } from '/core/themeManager.js';
    import { OnboardingManager } from '/modules/onboardingManager.js';

    document.addEventListener('DOMContentLoaded', async () => {
      await HeaderController.loadHeader();
      new ThemeManager();

      const manager = new OnboardingManager();
      const slides = document.querySelectorAll('.slide');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const skipBtn = document.getElementById('skipBtn');
      const progressFill = document.getElementById('onboardingProgress');
      const stepCounter = document.getElementById('stepCounter');

      let currentStep = 0;
      const totalSteps = slides.length;

      // === –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ ===
      function updateUI() {
        slides.forEach((slide, index) => {
          slide.classList.toggle('active', index === currentStep);
        });

        const progress = ((currentStep + 1) / totalSteps) * 100;
        progressFill.style.width = `${progress}%`;
        stepCounter.textContent = `–®–∞–≥ ${currentStep + 1} –∏–∑ ${totalSteps}`;

        prevBtn.disabled = currentStep === 0;
        nextBtn.textContent = currentStep === totalSteps - 1 ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å ‚Üí' : '–î–∞–ª–µ–µ ‚Üí';
      }

      // === –ö–Ω–æ–ø–∫–∏ ===
      prevBtn.addEventListener('click', () => {
        if (currentStep > 0) {
          currentStep--;
          updateUI();
        }
      });

      nextBtn.addEventListener('click', () => {
        if (currentStep < totalSteps - 1) {
          currentStep++;
          updateUI();
        } else {
          // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
          manager.complete();
          goToMain();
        }
      });

      skipBtn.addEventListener('click', () => {
        if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥?")) {
          manager.complete();
          goToMain();
        }
      });

      function goToMain() {
        window.location.href = '/index.html';
      }

      // === –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ===
      if (!manager.shouldShow()) {
        // –ï—Å–ª–∏ —É–∂–µ –ø—Ä–æ—à—ë–ª ‚Äî —Ä–µ–¥–∏—Ä–µ–∫—Ç
        window.location.href = '/index.html';
      } else {
        updateUI();
      }
    });
  </script>
</body>
</html>