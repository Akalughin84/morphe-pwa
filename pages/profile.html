<!DOCTYPE html>
<html lang="ru" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <title>–ü—Ä–æ—Ñ–∏–ª—å ‚Äî Morphe</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/icon-32.png">
  <link rel="apple-touch-icon" href="/assets/icons/icon-192.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#f97316">

  <!-- –°—Ç–∏–ª–∏ -->
  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="/styles-shared.css">
  <link rel="stylesheet" href="/styles-form.css">
  <link rel="stylesheet" href="/styles-header.css">
</head>
<body>

  <div id="header-placeholder"></div>

  <main id="main-content" tabindex="-1">
    <div class="container">
      <h1>üë§ –í–∞—à –ø—Ä–æ—Ñ–∏–ª—å</h1>

      <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å —Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é -->
      <div class="profile-progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è">
        <div class="progress-bar">
          <div class="bar-fill" id="profileProgressFill" style="width: 0%;"></div>
        </div>
        <div class="progress-label">
          <span>–ó–∞–ø–æ–ª–Ω–µ–Ω–æ: <strong id="profileProgressText">0%</strong></span>
          <span id="profileStatus">–ù–∞—á–Ω–∏—Ç–µ –∑–∞–ø–æ–ª–Ω—è—Ç—å</span>
        </div>
      </div>

      <!-- –†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ -->
      <div id="viewMode">
        <div class="card profile-card">
          <div class="profile-header">
            <div class="profile-avatar">üë§</div>
            <div class="profile-greeting">
              <strong id="greeting">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</strong>
              <small>–ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º!</small>
            </div>
          </div>

          <div class="profile-grid">
            <div class="profile-item">
              <small class="text-muted">–ò–º—è</small>
              <div class="value" id="v-name">‚Äî</div>
            </div>
            <div class="profile-item">
              <small class="text-muted">–ü–æ–ª</small>
              <div class="value" id="v-gender">‚Äî</div>
            </div>
            <div class="profile-item">
              <small class="text-muted">–í–æ–∑—Ä–∞—Å—Ç</small>
              <div class="value" id="v-age">‚Äî</div>
            </div>
            <div class="profile-item">
              <small class="text-muted">–†–æ—Å—Ç / –í–µ—Å</small>
              <div class="value"><span id="v-height">‚Äî</span> —Å–º / <span id="v-weight">‚Äî</span> –∫–≥</div>
            </div>
          </div>

          <hr class="divider">

          <div class="profile-grid">
            <div class="profile-item">
              <small class="text-muted">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</small>
              <div class="pill" id="v-activity-pill">‚Äî</div>
            </div>
            <div class="profile-item">
              <small class="text-muted">–¢–∏–ø —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</small>
              <div class="value" id="v-workoutType">‚Äî</div>
            </div>
            <div class="profile-item">
              <small class="text-muted">–ú–µ—Å—Ç–æ</small>
              <div class="value" id="v-workoutLocation">‚Äî</div>
            </div>
            <div class="profile-item">
              <small class="text-muted">–¶–µ–ª—å</small>
              <div class="pill" id="v-goal-pill">‚Äî</div>
            </div>
          </div>
        </div>

        <button id="editBtn" class="btn-primary btn-large" style="width: 100%;">
          ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
        </button>
      </div>

      <!-- –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
      <div id="editMode" style="display: none;">
        <p class="form-intro">
          –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ ‚Äî –º—ã –ø–æ–¥–±–µ—Ä—ë–º –ø—Ä–æ–≥—Ä–∞–º–º—É —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å.
        </p>

        <div class="progress-bar" style="margin-bottom: 1.5rem;" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="25">
          <div class="bar-fill" id="progressBar" style="width: 25%;"></div>
        </div>

        <form id="profileForm" novalidate>
          <!-- –®–∞–≥ 1: –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
          <div class="step active" data-step="1">
            <div class="card">
              <h3>üßç‚Äç‚ôÇÔ∏è –õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
              <div class="form-group">
                <label for="name">–ò–º—è</label>
                <input type="text" id="name" name="name" autocapitalize="words" required placeholder="–ê–ª–µ–∫—Å–µ–π">
              </div>
              <div class="form-group">
                <label>–ü–æ–ª</label>
                <div class="radio-group">
                  <label><input type="radio" name="gender" value="male" required> –ú—É–∂—Å–∫–æ–π</label>
                  <label><input type="radio" name="gender" value="female"> –ñ–µ–Ω—Å–∫–∏–π</label>
                </div>
              </div>
              <div class="form-group">
                <label for="age">–í–æ–∑—Ä–∞—Å—Ç</label>
                <input type="number" id="age" name="age" inputmode="numeric" min="14" max="99" required placeholder="28">
              </div>
            </div>
          </div>

          <!-- –®–∞–≥ 2: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ª–∞ -->
          <div class="step" data-step="2">
            <div class="card">
              <h3>üìè –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ª–∞</h3>
              <div class="form-group">
                <label for="height">–†–æ—Å—Ç (—Å–º)</label>
                <input type="number" id="height" name="height" inputmode="numeric" min="140" max="230" required placeholder="178">
              </div>
              <div class="form-group">
                <label for="weight">–í–µ—Å (–∫–≥)</label>
                <input type="number" id="weight" name="weight" inputmode="decimal" step="0.1" min="40" max="200" required placeholder="75.5">
              </div>
            </div>
          </div>

          <!-- –®–∞–≥ 3: –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å -->
          <div class="step" data-step="3">
            <div class="card">
              <h3>‚ö° –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h3>
              <div class="form-group">
                <label>–ì–¥–µ –≤—ã —Ç—Ä–µ–Ω–∏—Ä—É–µ—Ç–µ—Å—å?</label>
                <div class="radio-group">
                  <label><input type="radio" name="workoutLocation" value="gym" required> –í –∑–∞–ª–µ</label>
                  <label><input type="radio" name="workoutLocation" value="home"> –î–æ–º–∞ –∏–ª–∏ –Ω–∞ —É–ª–∏—Ü–µ</label>
                </div>
              </div>
              <div class="form-group">
                <label>–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã —É–¥–µ–ª—è–µ—Ç–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –Ω–µ–¥–µ–ª—é?</label>
                <small class="form-hint">–£—á–∏—Ç—ã–≤–∞–µ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, —Ö–æ–¥—å–±—É, —Ä–∞–±–æ—Ç—É –∏ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.</small>
                <div class="radio-group">
                  <label>
                    <input type="radio" name="activity" value="1.2" required>
                    <strong>–ú–∏–Ω–∏–º—É–º –¥–≤–∏–∂–µ–Ω–∏—è</strong><br>
                    <small>–ú–µ–Ω–µ–µ 1.5 —á–∞—Å–æ–≤ | –°–∏–¥—è—á–∞—è —Ä–∞–±–æ—Ç–∞</small>
                  </label>
                  <label>
                    <input type="radio" name="activity" value="1.375">
                    <strong>–õ—ë–≥–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</strong><br>
                    <small>1.5‚Äì3 —á–∞—Å–∞ | 1‚Äì3 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</small>
                  </label>
                  <label>
                    <input type="radio" name="activity" value="1.55">
                    <strong>–°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</strong><br>
                    <small>3‚Äì5 —á–∞—Å–æ–≤ | 3‚Äì5 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</small>
                  </label>
                  <label>
                    <input type="radio" name="activity" value="1.725">
                    <strong>–í—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</strong><br>
                    <small>5‚Äì7 —á–∞—Å–æ–≤ | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ</small>
                  </label>
                  <label>
                    <input type="radio" name="activity" value="1.9">
                    <strong>–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è</strong><br>
                    <small>–ë–æ–ª–µ–µ 7 —á–∞—Å–æ–≤ | –†–∞–±–æ—Ç–∞ + —Å–ø–æ—Ä—Ç</small>
                  </label>
                </div>
              </div>
            </div>
          </div>

          <!-- –®–∞–≥ 4: –¶–µ–ª—å -->
          <div class="step" data-step="4">
            <div class="card">
              <h3>üéØ –¶–µ–ª—å –∏ —Å—Ç–∏–ª—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h3>
              <div class="form-group">
                <label>–ö–∞–∫–∞—è —É –≤–∞—Å —Ü–µ–ª—å?</label>
                <div class="radio-group">
                  <label><input type="radio" name="goal" value="lose" required> –°–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å</label>
                  <label><input type="radio" name="goal" value="maintain"> –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ñ–æ—Ä–º—É</label>
                  <label><input type="radio" name="goal" value="gain"> –ù–∞–±—Ä–∞—Ç—å –º–∞—Å—Å—É</label>
                </div>
              </div>
              <div class="form-group">
                <label for="workoutType">–ö–∞–∫–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤–∞–º –±–ª–∏–∂–µ?</label>
                <select id="workoutType" name="workoutType" required>
                  <option value="balanced">–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ (—Å–∏–ª–∞ + –∫–∞—Ä–¥–∏–æ)</option>
                  <option value="cardio">–ë–æ–ª—å—à–µ –∫–∞—Ä–¥–∏–æ</option>
                  <option value="strength">–ë–æ–ª—å—à–µ —Å–∏–ª–æ–≤—ã—Ö</option>
                  <option value="light">–õ—ë–≥–∫–∏–µ –∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ</option>
                </select>
              </div>
              <!-- –í —à–∞–≥–µ "–¶–µ–ª—å" -->
              <div class="form-group">
                <label for="targetWeight">–ñ–µ–ª–∞–µ–º—ã–π –≤–µ—Å (–∫–≥)</label>
                <input type="number" id="targetWeight" name="targetWeight" step="0.5" min="40" max="200" placeholder="80.0">
                <small class="form-hint">–£–∫–∞–∂–∏—Ç–µ –≤–µ—Å, –∫ –∫–æ—Ç–æ—Ä–æ–º—É —Å—Ç—Ä–µ–º–∏—Ç–µ—Å—å. –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è.</small>
              </div>
            </div>
          </div>

          <div id="formFeedback" class="form-feedback" aria-live="polite"></div>
        </form>

        <!-- –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
        <div class="profile-form-footer">
          <div class="form-nav-buttons">
            <button id="prevBtn" type="button" class="btn-outline" style="display: none;">‚Üê –ù–∞–∑–∞–¥</button>
            <button id="cancelBtn" type="button" class="btn-text">–û—Ç–º–µ–Ω–∞</button>
            <button id="nextBtn" type="button" class="btn-primary btn-large">–î–∞–ª–µ–µ ‚Üí</button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <div id="footer-placeholder"></div>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js');
      });
    }
  </script>

  <script type="module" src="/js/profile.js"></script>

  <style>
  :root {
    --bg-surface: #ffffff;
    --bg-card: #fafafa;
    --text-primary: #1e293b;
    --text-secondary: #475569;
    --text-tertiary: #94a3b8;
    --border: #e2e8f0;
    --accent: #f97316;
    --accent-hover: #ea580c;
    --success: #10b981;
    --shadow: rgba(0, 0, 0, 0.05);
    --radius: 16px;
    --transition: all 0.25s ease;
  }

  [data-theme="dark"] {
    --bg-surface: #0f172a;
    --bg-card: #1e293b;
    --text-primary: #f1f5f9;
    --text-secondary: #cbd5e1;
    --text-tertiary: #94a3b8;
    --border: #334155;
    --shadow: rgba(0, 0, 0, 0.2);
  }

  * {
    box-sizing: border-box;
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background-color: var(--bg-surface);
    color: var(--text-primary);
    line-height: 1.6;
    margin: 0;
    padding: 0;
  }

  .container {
    max-width: 800px;
    margin: 0 auto;
    padding: 1.5rem;
  }

  h1 {
    font-size: 1.75rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  /* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä */
  .profile-progress {
    margin-bottom: 2rem;
  }

  .progress-bar {
    height: 8px;
    background-color: var(--border);
    border-radius: 4px;
    overflow: hidden;
  }

  .bar-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), #fb923c);
    transition: width 0.4s ease;
    border-radius: 4px;
  }

  .progress-label {
    display: flex;
    justify-content: space-between;
    color: var(--text-tertiary);
    font-size: 0.875rem;
    margin-top: 0.5rem;
  }

  /* –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è */
  .profile-card {
    background: var(--bg-card);
    border-radius: var(--radius);
    padding: 1.75rem;
    box-shadow: 0 4px 12px var(--shadow);
    margin-bottom: 1.5rem;
    transition: var(--transition);
  }

  .profile-header {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 1.75rem;
  }

  .profile-avatar {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background: var(--accent);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.75rem;
    flex-shrink: 0;
  }

  .profile-greeting strong {
    font-size: 1.4rem;
    color: var(--text-primary);
    display: block;
  }

  .profile-greeting small {
    color: var(--text-tertiary);
    font-size: 0.95rem;
  }

  .profile-grid {
    display: grid;
    gap: 1.25rem;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  }

  .profile-item small {
    display: block;
    color: var(--text-tertiary);
    font-size: 0.85rem;
    margin-bottom: 0.35rem;
  }

  .profile-item .value {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 1.05rem;
  }

  .pill {
    display: inline-block;
    background: rgba(249, 115, 22, 0.1);
    color: var(--accent);
    padding: 0.35rem 0.75rem;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 600;
  }

  .divider {
    border: none;
    border-top: 1px solid var(--border);
    margin: 1.75rem 0;
  }

  /* –ö–Ω–æ–ø–∫–∏ */
  .btn-primary {
    background: var(--accent);
    color: white;
    border: none;
    padding: 0.85rem 1.25rem;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    font-size: 1rem;
  }

  .btn-primary:hover {
    background: var(--accent-hover);
    transform: translateY(-2px);
  }

  .btn-outline {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text-primary);
    padding: 0.85rem 1.25rem;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
  }

  .btn-text {
    background: none;
    border: none;
    color: var(--text-tertiary);
    font-weight: 600;
    cursor: pointer;
    padding: 0.85rem;
    border-radius: 12px;
    transition: var(--transition);
  }

  .btn-text:hover {
    color: var(--accent);
  }

  /* –§–æ—Ä–º–∞ */
  .form-intro {
    color: var(--text-secondary);
    margin-bottom: 1.5rem;
    font-size: 1.1rem;
    text-align: center;
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  .form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: var(--text-primary);
  }

  input[type="text"],
  input[type="number"],
  select {
    width: 100%;
    padding: 0.85rem 1rem;
    border: 1px solid var(--border);
    border-radius: 12px;
    background: var(--bg-surface);
    color: var(--text-primary);
    font-size: 1rem;
    transition: var(--transition);
  }

  input:focus,
  select:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.2);
  }

  .radio-group {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-top: 0.5rem;
  }

  .radio-group label {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 1rem;
    border: 1px solid var(--border);
    border-radius: 12px;
    cursor: pointer;
    transition: var(--transition);
    background: var(--bg-surface);
  }

  .radio-group input[type="radio"] {
    margin-top: 0.25rem;
    accent-color: var(--accent);
  }

  .radio-group label:hover {
    border-color: var(--accent);
    background: rgba(249, 115, 22, 0.03);
  }

  .radio-group input[type="radio"]:checked + label {
    border-color: var(--accent);
    background: rgba(249, 115, 22, 0.08);
  }

  .form-hint {
    display: block;
    margin-top: 0.5rem;
    color: var(--text-tertiary);
    font-size: 0.875rem;
  }

  /* –ê–Ω–∏–º–∞—Ü–∏–∏ —à–∞–≥–æ–≤ */
  .step {
    display: none;
    animation: fadeIn 0.35s ease forwards;
  }

  .step.active {
    display: block;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã */
  .form-nav-buttons {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    gap: 1rem;
  }

  .profile-form-footer {
    margin-top: 2rem;
    display: flex;
    justify-content: center;
  }

  /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
  @media (max-width: 768px) {
    .container {
      padding: 1rem;
    }

    h1 {
      font-size: 1.5rem;
    }

    .profile-card {
      padding: 1.25rem;
    }

    .profile-grid {
      grid-template-columns: 1fr;
    }

    .form-nav-buttons {
      flex-direction: column;
      align-items: stretch;
    }

    #prevBtn, #cancelBtn, #nextBtn {
      width: 100%;
      margin-bottom: 0.75rem;
    }

    .profile-form-footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: var(--bg-surface);
      padding: 16px;
      box-shadow: 0 -4px 12px var(--shadow);
      z-index: 100;
      justify-content: center;
    }

    #editMode {
      padding-bottom: 140px;
    }

    .radio-group label {
      padding: 0.85rem;
    }
  }

  /* –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
  #profileStatus {
    color: var(--accent);
    font-weight: 600;
  }

  /* –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å —Ñ–æ—Ä–º—ã */
  .form-feedback {
    margin-top: 1rem;
    padding: 0.75rem;
    border-radius: 12px;
    text-align: center;
    font-weight: 500;
  }

  .form-feedback.success {
    background: rgba(16, 185, 129, 0.1);
    color: var(--success);
  }

  .form-feedback.error {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
  }
</style>
</body>
</html>